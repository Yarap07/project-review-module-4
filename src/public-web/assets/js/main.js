"use strict";let kittenDataList=[],githubUser="garcia-laura";const KittenList=document.querySelector(".js-list"),inputSearchDesc=document.querySelector(".js_in_search_desc"),inputSearchRace=document.querySelector(".js_in_search_race"),searchButton=document.querySelector(".js_in_search_button"),errorMessageSearch=document.querySelector(".js_label_in_search_error"),headerIcon=document.querySelector(".js-icon"),NewKittenForm=document.querySelector(".js-new-form"),descInputForm=document.querySelector(".js-input-desc"),photoInputForm=document.querySelector(".js-input-photo"),nameInputForm=document.querySelector(".js-input-name"),raceInputForm=document.querySelector(".js-input-race"),addBtn=document.querySelector(".js-btn-add"),cancelBtn=document.querySelector(".js-cancel-button"),labelMessageForm=document.querySelector(".js-label-message"),kittenLS=JSON.parse(localStorage.getItem("kittensList"));function getKittenList(){fetch("http://localhost:4000/api/kittens/"+githubUser,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{kittenDataList=e.results,console.log(kittenDataList),renderKittenList(kittenDataList),localStorage.setItem("kittensList",JSON.stringify(kittenDataList))}).catch(e=>{console.error(e)})}null!==kittenLS?renderKittenList(kittenLS):getKittenList();const toLowerCaseText=e=>e.toLowerCase();function showNewCatForm(){NewKittenForm.classList.remove("collapsed")}function hideNewCatForm(){NewKittenForm.classList.add("collapsed")}function handleClickNewCatForm(e){e.preventDefault(),NewKittenForm.classList.contains("collapsed")?showNewCatForm():hideNewCatForm()}function renderRace(e){return""===e?"No se ha especificado la raza":""+e}function renderKitten(e){const t=document.createElement("li");t.setAttribute("class","card");const n=document.createElement("article"),r=document.createElement("img");r.setAttribute("class","card_img"),r.setAttribute("src",e.image),r.setAttribute("alt","gatito");const a=document.createElement("h3"),o=document.createTextNode(e.name);a.appendChild(o),a.setAttribute("class","card_title");const c=document.createElement("h3"),s=document.createTextNode(renderRace(e.race));c.appendChild(s),c.setAttribute("class","card_race");const i=document.createElement("p"),l=document.createTextNode(e.desc);return i.appendChild(l),i.setAttribute("class","card_description"),t.appendChild(n),n.appendChild(r),n.appendChild(a),n.appendChild(c),n.appendChild(i),t}function renderKittenList(e){for(let t=0;t<e.length;t++)KittenList.appendChild(renderKitten(e[t]));console.log(KittenList)}function addNewKitten(e){e.preventDefault();const t={image:photoInputForm.value,name:nameInputForm.value,race:raceInputForm.value,desc:descInputForm.value};fetch("http://localhost:4000/api/kittens/"+githubUser,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{if(console.log(e),e.success){kittenDataList.push(t),renderKittenList(kittenDataList),localStorage.setItem("kittenDataList",JSON.stringify(kittenDataList));const e=document.querySelectorAll(".label_new_kitten");let n=0;for(n=0;n<e.length;n++)e[n].value="";labelMessageForm.innerHTML="¡Mola! ¡Un nuevo gatito en Adalab!"}else labelMessageForm.innerHTML="Error. Gatito perdido"}).catch(e=>{console.error(e)})}function cancelNewKitten(e){e.preventDefault();const t=document.querySelectorAll(".label_new_kitten");let n=0;for(n=0;n<t.length;n++)t[n].value="";NewKittenForm.classList.add("collapsed")}function filterKitten(){const e=toLowerCaseText(inputSearchDesc.value),t=toLowerCaseText(inputSearchRace.value);renderKittenList(kittenDataList.filter(n=>toLowerCaseText(n.desc).includes(e)&&toLowerCaseText(n.race).includes(t)))}function emptyFilter(){errorMessageSearch.innerHTML="Debe rellenar todos los valores, por favor"}searchButton.addEventListener("click",e=>{e.preventDefault();const t=toLowerCaseText(inputSearchDesc.value),n=toLowerCaseText(inputSearchRace.value);""===t&&""===n?emptyFilter():(""!==t&&""===n||""===t&&""!==n||""!==t&&""!==n)&&filterKitten()}),headerIcon.addEventListener("click",handleClickNewCatForm),addBtn.addEventListener("click",addNewKitten),cancelBtn.addEventListener("click",cancelNewKitten);